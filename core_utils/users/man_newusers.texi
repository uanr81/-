newusers(8)                    Команды управления системой                    newusers(8)

НАЗВАНИЕ
       newusers - обновляет и создаёт новые учётные записи пользователей в пакетном
       режиме

СИНТАКСИС
       newusers [параметры] [файл]

ОПИСАНИЕ
       Программа newusers читает файл (или по умолчанию стандартный ввод) и использует
       эту информацию для обновления группы существующих или создания новых учётных
       записей. Каждая строка имеет формат стандартного файла паролей (смотрите
       passwd(5)) за исключением:

       pw_name:pw_passwd:pw_uid:pw_gid:pw_gecos:pw_dir:pw_shell

       pw_name
           Имя пользователя.

           Это может быть имя нового пользователя или имя существующего пользователя (или
           пользователя, созданного newusers ранее). Если пользователь существует, то
           будет изменена информация о пользователе, или же создаётся новый пользователь.

       pw_passwd
           Это поле будет зашифровано и использовано как новое значение шифрованного
           пароля.

        pw_gid
           Это поле используется для определения UID пользователя.

           Если это поле пусто, то командой newusers автоматически определяется новый
           (неиспользованный) UID.

           Если в этом поле указано число, то оно будет использовано в качестве UID.

           Если в поле содержится имя существующего пользователя (или имя пользователя,
           созданного newusers ранее), то использует UID указанного пользователя.

           Если изменяется UID существующего пользователя, то у файлов, которыми владел
           этот пользователь, нужно вручную переопределить владельца.

       pw_gid
           Это поле используется для определения ID первичной группы пользователя.

           Если в этом поле содержится имя существующей группы (или группы, созданной
           newusers ранее), то в качестве ID первичной группы пользователя будет
           использован GID этой группы.

           Если в этом поле содержится число, то это число будет использовано как ID
           первичной группы пользователя. Если с таким GID не существует, то будет
           создана новая группа с этим GID и именем пользователя.

           Если это поле пусто, то новая группа будет создана с именем пользователя, а
           GID будет определён newusers автоматически (для использования в качестве ID
           первичной группы пользователя и GID новой группы).

           Если поле содержит имя группы, которой не существует (и которая не была
           создана newusers ранее), то будет создана новая группа с указанным именем, GID
           будет определён newusers автоматически (для использования в качестве ID
           первичной группы пользователя и GID новой группы).

       pw_gecos
           Это поле копируется в поле GECOS записи пользователя.

       pw_dir
           Это поле используется для определения домашнего каталога пользователя.

           Если это поле указывает на несуществующий каталог, то указанный каталог
           создаётся, его владельцем назначается создаваемый или обновляемый пользователь
           и его первичная группа.

           Если изменяется домашний каталог существующего пользователя, то команда
           newusers не перемещает или копирует содержимое старого каталога в новое место.
           Это нужно выполнить вручную.

       pw_shell
           В этом поле задаётся пользовательская оболочка. Никаких проверок поля не
           делается.

       Команда newusers сначала пытается создать или изменить всех указанных
       пользователей, а затем записать эти изменения в базы данных пользователей или
       групп. Если происходит ошибка (кроме ошибок при последней записи в базы данных),
       то изменения в базы не сохраняются.

       Во время первого прохода пользователи создаются с заблокированными паролями (у
       несоздаваемых пользователей пароли не изменяются). Во время второго прохода
       выполняется обновление паролей с помощью PAM. При возникновении ошибок при
       обновлении об этом сообщается, но обновление паролей продолжается.

       Данная команда предназначена для работы в крупных системных средах, где за один
       раз обновляется несколько учётных записей.

ПАРАМЕТРЫ
       Параметры команды newusers:

       -h, --help
           Показать краткую справку и закончить работу.

       -r, --system
           Создать системную учётную запись.

           Системные пользователи создаются без информации об устаревании в /etc/shadow,
           и их числовые идентификаторы выбираются из диапазона SYS_UID_MIN-SYS_UID_MAX,
           определённого в login.defs, а не из UID_MIN-UID_MAX (это же касается и части с
           GID при создании групп).

       -R, --root КАТ_CHROOT
           Выполнить изменения в каталоге КАТ_CHROOT и использовать файлы настройки из
           каталога КАТ_CHROOT.

ПРЕДОСТЕРЕЖЕНИЯ
       Файл с входными данными должен быть защищён, так как в нём содержатся не
       шифрованные пароли.

НАСТРОЙКА
       На работу этого инструмента влияют следующие переменные настройки из
       /etc/login.defs:

       GID_MAX (число), GID_MIN (число)
           Диапазон идентификаторов групп, используемый в программах useradd, groupadd
           или newusers для создания обычных групп.

           Значение по умолчанию для GID_MIN (соотв.  GID_MAX) равно 1000 (соотв. 60000).

       MAX_MEMBERS_PER_GROUP (число)
           Максимальное количество членов в записи о группе. При достижения максимума
           заводится новая запись группы (строка) в /etc/group (с тем же именем, паролем
           и тем же GID).

           Значение по умолчанию равно 0, означающее, что ограничения на количество
           членов в группе нет.

           Данная возможность (разделение группы) позволяет ограничить длину строк в
           файле групп. Это полезно для ограничения длины строк групп NIS в 1024 символа.

           Если вам нужно такое ограничение, укажите значение 25.

           Замечание: разделение групп поддерживается не всеми инструментами (даже в
           наборе инструментов Shadow). Вы не должны использовать эту переменную, если
           вам действительно это ненужно.

       PASS_MAX_DAYS (число)
           Максимальное число дней использования пароля. Если пароль старее этого числа,
           то будет запущена процедура смены пароля. Если значение не задано, то
           предполагается значение -1 (то есть возможность ограничения не используется).

       PASS_MIN_DAYS (число)
           Максимальное число дней между изменениями пароля. Любая смена пароля ранее
           заданного срока выполнена не будет. Если значение не задано, то предполагается
           значение -1 (то есть возможность ограничения не используется).

       PASS_WARN_AGE (число)
           Число дней за которое начнёт выдаваться предупреждение об устаревании пароля.
           Нулевое значение означает, что предупреждение выдаётся в день устаревания, при
           отрицательном значении предупреждение выдаваться не будет. Если значение не
           задано, выдача предупреждения отключается.

       SUB_GID_MIN (number), SUB_GID_MAX (number), SUB_GID_COUNT (number)
           If /etc/subuid exists, the commands useradd and newusers (unless the user
           already have subordinate group IDs) allocate SUB_GID_COUNT unused group IDs
           from the range SUB_GID_MIN to SUB_GID_MAX for each new user.

           The default values for SUB_GID_MIN, SUB_GID_MAX, SUB_GID_COUNT are
           respectively 100000, 600100000 and 10000.

       SUB_UID_MIN (number), SUB_UID_MAX (number), SUB_UID_COUNT (number)
           If /etc/subuid exists, the commands useradd and newusers (unless the user
           already have subordinate user IDs) allocate SUB_UID_COUNT unused user IDs from
           the range SUB_UID_MIN to SUB_UID_MAX for each new user.

           The default values for SUB_UID_MIN, SUB_UID_MAX, SUB_UID_COUNT are
           respectively 100000, 600100000 and 10000.

       SYS_GID_MAX (число), SYS_GID_MIN (число)
           Диапазон идентификаторов групп, используемый в программах useradd, groupadd
           или newusers для создания системных групп.

           Значение по умолчанию для SYS_GID_MIN (соотв.SYS_GID_MAX) равно 101 (соотв.
           GID_MIN-1).

       SYS_UID_MAX (число), SYS_UID_MIN (число)
           Диапазон идентификаторов пользователей, используемый в программах useradd или
           newusers для создания системных пользователей.

           Значение по умолчанию для SYS_UID_MIN (соотв.  SYS_UID_MAX) равно 101 (соотв.
           UID_MIN-1).

       UID_MAX (число), UID_MIN (число)
           Диапазон идентификаторов пользователей, используемый в программах useradd или
           newusers для создания обычных пользователей.

           Значение по умолчанию для UID_MIN (соотв.  UID_MAX) равно 1000 (соотв. 60000).

       UMASK (число)
           Задаёт начальное значение маски доступа для создаваемых файлов. Если не
           указано, то маска устанавливается в 022.

           Команды useradd и newusers используют эту маску для установки прав доступа к
           домашнему каталогу, который они создают.

           Она также используется командой pam_umask как значение umask по умолчанию.

ФАЙЛЫ
       /etc/passwd
           содержит информацию о пользователях

       /etc/shadow
           содержит защищаемую информацию о пользователях

       /etc/group
           содержит информацию о группах

       /etc/gshadow
           содержит защищаемую информацию о группах

       /etc/login.defs
           содержит конфигурацию подсистемы теневых паролей

       /etc/pam.d/newusers
           настройки PAM для newusers

       /etc/subgid
           Per user subordinate group IDs.

       /etc/subuid
           Per user subordinate user IDs.

СМОТРИТЕ ТАКЖЕ
       login.defs(5), passwd(1), subgid(5), subuid(5), useradd(8).

shadow-utils 4.2                        03/26/2019                            newusers(8)
